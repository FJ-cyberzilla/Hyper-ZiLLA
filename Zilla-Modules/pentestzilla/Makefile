# PentestZilla Unified Makefile

CC = g++
CXXFLAGS = -std=c++20 -O3
GO = go

# Output directories
BIN_DIR = bin
BUILD_DIR = build

# Targets
PENTESTZILLA_SRC = src/cpp/pentestzilla/emergency_fix.cpp
PENTESTZILLA_V4_SRC = src/cpp/pentestzilla/pentestzilla_v4.cpp
ZILLATOOTH_SRC = src/cpp/zillatooth/zillatooth.cpp
TOPGEAR_SRC = src/go/topgear/main.go

# Binaries
PENTESTZILLA_BIN = $(BIN_DIR)/pentestzilla
PENTESTZILLA_V4_BIN = $(BIN_DIR)/pentestzilla_v4
ZILLATOOTH_BIN = $(BIN_DIR)/zillatooth
TOPGEAR_BIN = $(BIN_DIR)/zillabreath

.PHONY: all clean pentestzilla zillatooth zillabreath directories

all: directories pentestzilla zillabreath

directories:
	mkdir -p $(BIN_DIR)

pentestzilla: directories $(PENTESTZILLA_SRC)
	$(CC) -std=c++17 $(PENTESTZILLA_SRC) -o $(PENTESTZILLA_BIN) -lpthread

pentestzilla_v4: directories $(PENTESTZILLA_V4_SRC)
	$(CC) -std=c++17 $(PENTESTZILLA_V4_SRC) -o $(PENTESTZILLA_V4_BIN) -lcrypto -lcurl -lpthread

zillabreath: directories
	cd src/go/topgear && $(GO) build -o ../../../$(TOPGEAR_BIN) main.go

clean:
	rm -rf $(BIN_DIR)
