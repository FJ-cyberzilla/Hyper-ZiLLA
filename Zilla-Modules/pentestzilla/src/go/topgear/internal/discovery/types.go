package discovery

import (
	"time"
)

// ARPEntry represents an entry in the ARP table.
type ARPEntry struct {
	IPAddress  string
	MACAddress string
	HWType     string
	Flags      string
	Interface  string
}

// NeighborEntry represents an entry in the IP neighbor table.
type NeighborEntry struct {
	IPAddress  string
	MACAddress string
	Device     string
	State      string
}

// Service represents a network service found on a device.
type Service struct {
	Port        int
	Protocol    string
	Name        string // Service name, e.g., "http", "ssh"
	Version     string
	State       string // e.g., "open", "closed", "filtered"
	Product     string // e.g., "OpenSSH", "nginx"
	ExtraInfo   string // Additional information from Nmap scripts
	Risk        string // Assessed risk for this service
	Timestamp   time.Time
}

// NetworkDevice represents a single device discovered on the network.
type NetworkDevice struct {
        IPAddress     string
        MACAddress    string
        Hostname      string
        Vendor        string
        DeviceType    string
        OS            string
        Services      []Service // Consolidated service information
        Vulnerabilities []NmapVulnerability // Added field
        Interface     string
        NeighborState string
        RiskLevel     string // Overall risk level for the device
        Source        string // How the device was discovered (ARP, Nmap, etc.)
        FirstSeen     time.Time
        LastSeen      time.Time
}

// NetworkInfo provides an overview of the discovered network.
type NetworkInfo struct {
        Subnet       string
        TotalDevices int
        DeviceTypes  map[string]int // Count of devices by type
}

// ThreatAssessment summarizes potential threats found.
type ThreatAssessment struct {
        HighRiskDevices int
        Alerts          []string
        Recommendations []string
}

// ReconResults encapsulates all results from a comprehensive reconnaissance scan.
type ReconResults struct {
        Timestamp        time.Time
        Devices          []NetworkDevice
        NetworkInfo      *NetworkInfo
        ThreatAssessment *ThreatAssessment
        NmapRawOutput    string // Store raw Nmap output for debugging/detailed analysis
}

// NmapVulnerability represents a vulnerability detected by Nmap scripts.
type NmapVulnerability struct {
        ID          string // e.g., CVE-XXXX-YYYY, Nmap script ID
        Title       string
        Risk        string // e.g., "Critical", "High", "Medium", "Low", "Info"
        Description string
        Remediation string
        Component   string // Added field
        Reference   string
        Confidence  int    // Nmap script confidence (0-10)
        Host        string // IP address of the vulnerable host
        Port        int    // Port if service-specific
        Timestamp   time.Time
}

// NmapScanner encapsulates Nmap scanning logic and configuration.
type NmapScanner struct {
	InterfaceName string
	Timeout       int
	Intensity     int
}

// OSInfo represents operating system details.
type OSInfo struct {
	Details    string
	Confidence int // Nmap confidence score
	Timestamp  time.Time
}

// NmapHost represents a discovered host with Nmap-specific details.
type NmapHost struct {
        IPAddress     string
        MACAddress    string // MAC address, if discovered
        Hostname      string
        Vendor        string // Vendor information, if discovered
        DeviceType    string // e.g., phone, server, workstation
        OSInfo        OSInfo
        Services      []Service
        Vulnerabilities []NmapVulnerability
}

// NmapResults encapsulates the results of an Nmap scan.
type NmapResults struct {
        Timestamp time.Time
        Subnet    string
        Hosts     []NmapHost
        RawOutput string
}

// Placeholder for ClassifiedDevice - assuming it's an output of classification.// Its exact structure might depend on the classification logic.
type ClassifiedDevice struct {
	NetworkDevice
	Classification string // e.g., "Server", "Workstation", "IoT", "Mobile"
	Confidence     float64
}

// Placeholder for WirelessAP - if wireless scanning is implemented.
type WirelessAP struct {
    SSID       string
    BSSID      string
    Channel    int
    Encryption string
    Signal     int // dBm
    Clients    []string // Connected client MACs
    Timestamp  time.Time
    LastSeen   time.Time // Added LastSeen field
}

// Placeholder for BluetoothDevice - if Bluetooth scanning is implemented.
type BluetoothDevice struct {
    Name       string
    Address    string
    Type       string // e.g., LE, Classic
    Signal     int // RSSI
    Services   []string // Discovered Bluetooth services
    LastSeen   time.Time
}
